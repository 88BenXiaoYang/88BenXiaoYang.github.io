---
title: 知识拾遗
date: 2019-01-08 11:24:30
tags: 零散知识点
---

* `HTTP`状态码类别：

类型 | 原因短语
--- | ---
1XX Informational（信息性状态码）| 接收的请求正在处理
2XX Success（成功状态码）| 请求正常处理完毕
3XX Redirection （重定向状态码）| 需要进行附加操作以完成请求
4XX Client Error （客户端错误状态码）| 服务器无法处理请求
5XX Server Error （服务器错误状态码）| 服务器处理请求出错

* 不适合使用`HTTP`协议的场景
  1. 实时数据推送
     * 除了`iOS`开发提供有标准的`Apple`消息推送中心，其他移动产品可能还是要采用`Socket`长连接才能保证实时通讯。比较常见的很多即时通讯软件采用的是`XMPP`协议
  2. 流媒体
     * 用于音视频播放、语音会议等，一般采用`RTMP`协议

* 根据使用场景选择使用`get`或`post`请求方法

因各浏览器`HTTP Get`请求`URL`最大长度并不相同。
几类常用浏览器最大长度及超过最大长度后提交情况如下：

浏览器类型 | Get请求URL最大长度
--- | ---
IE6.0 | url最大长度2083个字符，超过最大长度后无法提交。
IE7.0 | url最大长度2083个字符，超过最大长度后仍然能提交，但是只能传过去2083个字符。
firefox 3.0.3 | url最大长度7764个字符，超过最大长度后无法提交。
Opera 9.52 | url最大长度7648个字符，超过最大长度后无法提交。
Google Chrome 2.0.168 | url最大长度7713个字符，超过最大长度后无法提交

---

* `emoji`表情

`emoji`表情是通用的，不只是移动端的系统(`iOS`、`Android`)支持，`PC`上也支持。`emoji`是个通用的字符集。虽然看到显示的是表情，但实际还是字符串。

开发中涉及到`emoji`表情时，遇到的常见问题是在和服务端调用接口时出现。因在调用接口时，上传的参数中有`emoji`表情时，`emoji`表情传递过去的也是字符串，只不过是特殊的字符串。一般情况下，服务端在写数据库的时候，是`UTF8`的编码方式。如服务端在操作数据库的时候用的是`UTF8`的编码方式，这样在上传的参数中如有`emoji`表情的特殊字符时，就会出现对于同一参数字符串上传和请求解析得到的结果不一样的问题。

解决上述问题，服务端在操作数据库的时候，将`UTF8`编码方式改成`utf8mb4`就可以了，因为`utf8mb4`编码方式是原样存储、读取的。修改可参考下面步骤进行操作：

1. 修改`my.cnf [mysqld] character-set-server=utf8mb4 [mysql] www.2cto.com default-character-set=utf8mb4`修改后重启`Mysql`
2. 以`root`身份登录`Mysql`，修改环境变量，将`character_set_client,character_set_connection,character_set_database,character_set_results,character_set_server`都修改成`utf8mb4`
3. 将已经建好的表也转换成`utf8mb4`命令：`alter table TABLE_NAME convert to character set utf8mb4 collate utf8mb4_bin;`(将`TABLE_NAME`替换成你的表名)

---

* 可通过以下方式，减少网络请求发起的次数
  * 采用缓存方式
     * 清理缓存的策略如下
         1. 根据超时时间限制进行清理（根据日志统计应用被使用的平均时长，设置合适的超时时间）
         2. 根据缓存数据大小进行清理（网络图片缓存，数据量大，适合针对缓存大小来清理缓存）
     * 策略的选择要根据具体`APP`的操作日志来决定
     * 时效性短的接口数据，不做缓存，实时请求
  * 采用适当策略
    1. 如页面刷新（下拉刷新时，在请求着陆之前，后面重复操作导致的`API`请求就可以不必发送了）
    2. 条件筛选，那就取消前面已经发送的请求（虽然很有可能这个请求已经被执行了，那么取消所带来的性能提升就基本没有了。但如果这个请求还在队列中待执行的话，那么对应的这次链接就可以省掉了）
    3. 用户操作会触发操作日志上报`server`（这种场景下，采用在本地记录用户的操作记录，当记录满一定数量（如`30`条）的时候发起一次请求将操作记录上传到服务器。然后每次`APP`启动的时候，上传一次上次遗留下来没上传的操作记录。这样能够有效降低用户设备的耗电量，同时提升网络层的性能）

---

* 针对`DNS`域名解析的优化
  * 移动设备的使用场景比较复杂，网络信号源会经常变换，信号源每变换一次，对应的`DNS`解析链路就会变换一次，那么原链路上的`DNS`缓存就不起作用了（因对于移动设备用户来说，信号源变换特别频繁，所以移动设备链路的`DNS`缓存可以默认为基本上没有）
  * `API`请求在`DNS`解析阶段耗时多的原因（大体上三个）
     1. 网络信号源变换频繁
     2. 移动设备上网的需求也特别频繁（用手机系统自带的本地`DNS`缓存，因这个原因，可能会被别的`DNS`缓存给挤出去被清理掉）
     3. 国内互联网环境由于`GFW`(防火长城)的存在（使得`DNS`服务速度会比正常情况慢不少）
  * 综上，针对`DNS`域名解析的优化方案是，索性直接走`IP`请求，就可绕过`DNS`服务的耗时

---

