---
title: 不同编码标准的编码与解码
date: 2019-09-30 10:03:41
tags:
---

### 常用的编码标准

* 常用的编码标准
  1. `GBK`
  2. `UTF-8`
  3. `ISO8859-1`

### 编码基础知识

为方便表示各种各样的语言，逐渐出现很多标准编码。最早的编码是`ISO8859-1`和`ASCII`编码相似。重要的有如下几个：

* `ISO8859-1`(通常称为`Latin-1`)
  * 属于**单字节编码**(一字节八位)，最多能表示的字符范围是`0～255`
  * 应用于英文系列，如，字母`a`的编码为`0x61=97`
  * `ISO8859-1`编码表示的字符范围很窄，无法表示中文字符
  * 由于是单字节编码，和计算机最基础的表示单位一致，因此多数时候仍旧使用`ISO8859-1`编码来表示。在很多协议上，默认使用该编码
  * 如，虽然“中文”两个字不存在`ISO8859-1`编码。以`GB2312`编码为例，对应的是“`d6d0 cec4`”两个字符，使用`ISO8859-1`编码时，则将它拆开为`4`个字节来表示“`d6 d0 ce c4`”。事实上，在进行存储的时候，是以字节为单位处理的。而如用`UTF`编码来对“中文”进行编码，使用`ISO8859-1`对其编码时，则是将它拆开为`6`个字节“`e4 b8 ad e6 96 87`”来表示。因此可以看出，通过`ISO8859-1`进行编码表示的方法，需要以另一种编码为基础。

* `GB2312/GBK`
  * 这是汉字的国标码，专门用来表示汉字，是双字节编码。
  * 英文字母和`ISO8859-1`一致，即英文字母兼容`ISO8859-1`编码
  * `GBK`编码能够用来同时表示繁体字和简体字，而`GB2312`只能表示简体字，`GBK`是兼容`GB2312`编码的

* `unicode`
  * 这是最统一的编码，可以用来表示所有语言的字符
  * 是定长双字节，也有四字节的编码
  * 包括英文字母在内
  * 它是不兼容`ISO8859-1`编码的，也不兼容其他编码
  * 相对于`ISO8859-1`编码来说，`unicode`编码只是在前面增加了一个`0`字节，如字母`a`对应的`unicode`编码为“`00 61`”
  * 注：定长编码便于计算机处理，`GB2312/GBK`不是定长编码。因`unicode`可以用来表示所有字符，所以在很多软件内部是使用`unicode`编码来处理的，如`java`

* `UTF`
  * `unicode`编码不兼容`ISO8859-1`编码，而且容易占用更多的空间，因对于英文字母`unicode`也需要两个字节来表示，所以`unicode`不便于传输和存储，因此产生了`UTF`编码
  * `UTF`编码兼容`ISO8859-1`编码，同时也可以用来表示所有语言的字符
  * `UTF`编码是不定长编码，每一个字符的长度从`1～6`个字节不等
  * `UTF`编码自带简单的校验功能
  * 通常英文字母都是用一个字节表示，汉字用三个字节
  * 注：虽说`UTF`是为了使用更少的空间而使用的，这只是相对于`unicode`编码来说的，如果已知是汉字，则使用`GB2312/GBK`无疑是最节省的。虽然`UTF`编码对汉字使用三个字节，但即使对于汉字网页，`UTF`编码也会比`unicode`编码节省，因网页中包含了很多的英文字符

### 常用编码的区别

`unicode`、`UTF-8`、`ISO8859-1`的区别，通过对字符的编码来体现。以对“中文”进行编码为例(查询对应的编码表得到下面结果)：

* `GB2312` 编码为 “`d6d0 cec4`”
* `unicode` 编码为 “`4e2d 6587`”
* `UTF` 编码为 “`e4b8ad e69687`”
* 这两个汉字没有`ISO8859-1`编码，但可以用`ISO8859-1`编码来表示

### 编码的使用

字符串在`java`内存中总是按`unicode`编码存储的。

`UTF-8`可以用来表示/编码所有字符。

在`java`中，使用`setCharacterEncoding`来设置`HTTP`请求时相应的编码，如果不指定提交内容的编码，则默认使用`ISO8859-1`编码，这样在处理时需要做进一步的处理。值得注意的是在执行`setCharacterEncoding()`之前，不能执行任何`getParameter()`。而且，该指定只对`POST`方法有效，对`GET`方法无效。因，`POST`方法在执行第一个`getParameter()`的时候，`java`将会按照编码分析所有的提交内容，而后续的`getParameter()`不再进行分析，所以`setCharacterEncoding()`无效。对于`GET`方法提交表单，提交的内容在`URL`中，一开始就已经按照编码分析所有的提交内容，`setCharacterEncoding()`自然就无效。

注：`ISO8859-1`是`java`网络传输使用的标准字符集，`GB2312`是标准中文字符集，当需要进行提交表单等网络传输操作的时候，需要把`ISO8859-1`转换为`GB2312`字符集显示，否则如果按浏览器的`GB2312`格式来解析`ISO8859-1`字符集的话，由于两者不兼容，所以会出现乱码。

* 规律
  * `UTF-8`编码可以用`GBK`和`ISO8859-1`解码后编回去
  * `GBK`编码后只能用`ISO8859-1`解码后编回去

* 在`JSP`页面获取表单的值时会出现乱码，有两种解决方法
  1. 在调用`getParameter`之前通过`request.setCharacterEncoding`设置字符编码
  2. 调用`new String(str.getBytes("iso8859-1"), "UTF-8");`编码后解码
